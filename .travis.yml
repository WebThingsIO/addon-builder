dist: bionic
sudo: required

language: node_js
node_js:
  - 8
  - 10
  - 12

env:
  global:
    - HOMEBREW_LOGS=/tmp/homebrew/logs
    - HOMEBREW_TEMP=/tmp/homebrew/tmp

os:
  - linux
  - osx

addons:
  homebrew:
    packages:
      - gnu-tar
    update: true

before_install:
  - mkdir -p /tmp/homebrew/logs
  - mkdir -p /tmp/homebrew/tmp
  - if [[ "${TRAVIS_OS_NAME}" == "linux" ]]; then ./before-install-linux.sh; fi

script:
- ./build-addons.sh

deploy:
  provider: s3
  access_key_id: AKIA43UV6GXGJCQQU75I
  secret_access_key:
    secure: "KLRgiSrwczfG2MFS1WG+I3d97CxZADUHyiKD70tI5V1q1KcJ/i1GcAz/dO9YsAS4458w249ClEMjEfv4cvCbM7w8qiGpwHLUJALnJDSGcVrIsukq1JC3+uEK2YSSWIBerKJAeqH9Q+ncY1cvw+nQAUvetWlrthqWVfVbrn1zhpDrTu3zNzST2bmvQ079MtOn8I45/xDOgwQdDcy6tzurTYpYQ+cHHAupyHvfSLuRduxB//Duu5MJnElTINfyF4rU2KLSLstOBiWBZGZCANrGXRpG6UGtgu74iga0N9VQl+n0o7p4UgMESXd1G14McS6P1b+lyMQf+4fgEhGuhEpPUiF1dDYxxUJkXrm/G3G/vyZgBGrNmm1OrtxmszXqhBOvuL/Y2c0GcNSHOE+aYwp8F49zkd6O2w1n7id4WsTx/WIgl0ZPgDMpBUKh2xBMqA1H43wXSjBnVLI7MDWNX9s3Xvvalfw21cAXrq0Ggx9bksBHEdravfUrdnCpARhV43pcC/UqjNXUIU35enhZigT1AHJBDTBYk+myuAysViCKKVyf66rjRRILDmqrJ1GqV1HAmlAyqoX5h0DigdLNSBiWyIzG3+IWAv4GOBK90ZgY/W9Xck9aPie5a/dJ7J+D2jsYDvEj34iwOvEAwY/AQ0NT/Fy25fS4BmtJFEGU1L2UVng="
  bucket: mozilla-gateway-addons
  region: us-west-2
  local-dir: builder
  upload-dir: builder
  acl: public_read
  skip_cleanup: true
